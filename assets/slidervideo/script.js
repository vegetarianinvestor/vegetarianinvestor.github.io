!function(){"use strict";var e,t=(e={},function(t){var i=$.Deferred();return t in e?e[t]?i.resolve(e[t]):i.reject("Preview image not found."):$("<img>").on("load",(function(){if(120===(this.naturalWidth||this.width)){var a=this.src.split("/").pop();switch(a){case"maxresdefault.jpg":this.src=this.src.replace(a,"sddefault.jpg");break;case"sddefault.jpg":this.src=this.src.replace(a,"hqdefault.jpg");break;case"hqdefault.jpg":this.src=this.src.replace(a,"default.jpg");break;default:e[t]=null,i.reject("Preview image not found.")}}else i.resolve(e[t]=this.src)})).attr("src","https://img.youtube.com/vi/"+t+"/maxresdefault.jpg"),i});$("html").hasClass("is-builder")||$(document).on("add.cards",(function(e){if($(e.target).hasClass("carousel")){var i=$("html").hasClass("desktop");$(e.target).outerFind("[data-bg-video-slide]").each((function(){var e=function(e){if("false"===e)return!1;var t=e.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(&\S+)?/);return!!t&&t[6]}($(this).attr("data-bg-video-slide"));if(e){var a=$('<div class="mbr-background-video-preview"></div>').css({display:"none",backgroundSize:"cover",backgroundPosition:"center"});$(".container-slide",this).before(a);var s,o,r,c=function(e){if("false"===e)return!1;var t=e.match(/(http:|https:|)\/\/(player.|www.)?(vimeo\.com|youtu(be\.com|\.be|be\.googleapis\.com))\/(video\/|embed\/|watch\?v=|v\/)?([A-Za-z0-9._%-]*)(&\S+)?/);return t&&/youtube/g.test(t[3])?"youtube":!(!t||!/vimeo/g.test(t[3]))&&"vimeo"}($(this).attr("data-bg-video-slide")),n=$(this).find(".mbr-overlay");"youtube"===c?(t(e).done((function(e){a.css("background-image",'url("'+e+'")').show()})),i&&$.fn.YTPlayer&&!$(this).find(".playerBox").length&&($(".container-slide",this).before('<div class="mbr-background-video"></div>').prev().YTPlayer({videoURL:e,containment:"self",showControls:!1,mute:!0}),n.length&&$(".YTPOverlay",this).css({opacity:n.css("opacity"),backgroundColor:n.css("background-color")}),$(this).find(".image_wrapper img").css("opacity","0"),$(this).find(".image_wrapper .mbr-overlay").css("opacity","0"))):(s=e,o=function(e){a.css("background-image",'url("'+e+'")').show()},(r=new XMLHttpRequest).open("GET","https://vimeo.com/api/v2/video/"+s+".json",!0),r.onreadystatechange=function(){if(4===this.readyState&&this.status>=200&&this.status<400){var e=JSON.parse(this.responseText);o(e[0].thumbnail_large)}},r.send(),r=null,i&&$.fn.vimeo_player&&!$(this).find(".playerBox").length&&($(".container-slide",this).before('<div class="mbr-background-video"></div>').prev().vimeo_player({videoURL:e,containment:"self",showControls:!1,mute:!0}),n.length&&$(".vimeo_player_overlay",this).css({opacity:n.css("opacity"),backgroundColor:n.css("background-color")})))}})),$(e.target).find(".carousel-item iframe").css({transitionProperty:"opacity",transitionDuration:"1000ms"}),$(this).on("slide.bs.carousel","section.carousel",(function(e){$(e.target).find(".carousel-item.active .mb_YTPlayer").each((function(){$(this).YTPPause()})),$(e.target).find(".carousel-item.active .vimeo_player").each((function(){$(this).v_pause()})),$(e.target).find(".carousel-item:not(.active) iframe").css("opacity",0)})),$(this).on("slid.bs.carousel","section.carousel",(function(e){$(e.target).find(".carousel-item.active .mb_YTPlayer").each((function(){$(this).YTPPlay()})),$(e.target).find(".carousel-item.active .vimeo_player").each((function(){$(this).v_play()})),$(e.target).find(".carousel-item.active iframe").resize().css("opacity",1)}))}}))}();